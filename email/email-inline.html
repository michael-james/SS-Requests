<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" style="--blue: #007bff; --breakpoint-lg: 992px; --breakpoint-md: 768px; --breakpoint-sm: 576px; --breakpoint-xl: 1200px; --breakpoint-xs: 0; --cyan: #17a2b8; --danger: #dc3545; --dark: #343a40; --font-family-monospace: SFMono-Regular,Menlo,Monaco,Consolas,'Liberation Mono','Courier New',monospace; --font-family-sans-serif: -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji'; --gray: #6c757d; --gray-dark: #343a40; --green: #28a745; --indigo: #6610f2; --info: #17a2b8; --light: #f8f9fa; --orange: #fd7e14; --pink: #e83e8c; --primary: #007bff; --purple: #6f42c1; --red: #dc3545; --secondary: #6c757d; --success: #28a745; --teal: #20c997; --warning: #ffc107; --white: #fff; --yellow: #ffc107; -ms-overflow-style: scrollbar; -ms-text-size-adjust: 100%; -webkit-tap-highlight-color: transparent; -webkit-text-size-adjust: 100%; box-sizing: border-box; font-family: sans-serif; line-height: 1.15;">
    <head style="box-sizing: border-box;">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" style="box-sizing: border-box;">
        <title style="box-sizing: border-box;"></title>
        
	   
       <div w3-include-html="../css.html" style="box-sizing: border-box;"></div>
    </head>
    <body style="background-color: #fff; box-sizing: border-box; color: #212529; font-family: -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji'; font-size: 1rem; font-weight: 400; line-height: 1.5; margin: 0; text-align: left;">
        <table border="0" cellpadding="0" cellspacing="0" height="100%" width="100%" id="bodyTable" style="border-collapse: collapse; box-sizing: border-box;">
            <tr style="box-sizing: border-box;">
                <td align="center" valign="top" style="box-sizing: border-box;">
                    <table border="0" cellpadding="20" cellspacing="0" id="emailContainer" style="border-collapse: collapse; box-sizing: border-box; max-width: 750px;">
                        <tr style="box-sizing: border-box;">
                            <td align="left" valign="top" style="box-sizing: border-box;">
                            
<?  console.log('working...');
    console.log(d);
    var d = d || getRequest(66);
    console.log(d);
	var info = position(d.row); ?>


<h3 style="box-sizing: border-box; color: inherit; font-family: inherit; font-size: 1.75rem; font-weight: 500; line-height: 1.2; margin-bottom: .5rem; margin-top: 0;"><strong style="box-sizing: border-box; font-weight: bolder;">SS Request Update</strong> / <?= d.id ?></h3>
<h3 style="box-sizing: border-box; color: inherit; font-family: inherit; font-size: 1.75rem; font-weight: 500; line-height: 1.2; margin-bottom: .5rem; margin-top: 0;"><?= d.status ?></h3>
<h4 style="box-sizing: border-box; color: inherit; font-family: inherit; font-size: 1.5rem; font-weight: 500; line-height: 1.2; margin-bottom: .5rem; margin-top: 0;"><?= d.client + ' ' + d.protocol + (d.batch && (' Batch ' + d.batch)) ?> &mdash; <?= d.reqCode ?></h4>
<h5 class="mb-4 text-secondary" style="box-sizing: border-box; color: #6c757d !important; font-family: inherit; font-size: 1.25rem; font-weight: 500; line-height: 1.2; margin-bottom: 1.5rem !important; margin-top: 0;"><?= moment().format(ERTdf) ?></h5>

<p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">
<? if (!d.dFiles && d.startDate) { ?>
	We <?= d.daysStart < 0 ? 'were' : 'are' ?> expecting your <strong style="box-sizing: border-box; font-weight: bolder;">files</strong> <span class="text-info" style="box-sizing: border-box; color: #17a2b8 !important;"><?= bdText(d.startDate && d.startDate.format(dfo), d.daysStart, 0) ?></span>. When they arrive, please place them on <strong style="box-sizing: border-box; font-weight: bolder;"><?= d.server.slice(4) ?></strong> at the file path* <u style="box-sizing: border-box;"><?= d.server[0] ?>:/<?= d.client ?>/<?= d.protocol ?>/z - To Assistant/<strong style="box-sizing: border-box; font-weight: bolder;"><?= d.timestamp && d.timestamp.format("YYYY.MM.DD") ?> -- <?= d.id ?></strong></u> and <a href="<?=url?>?page=View&row=<?= d.row ?>" target="_blank" style="-webkit-text-decoration-skip: objects; background-color: transparent; box-sizing: border-box; color: #007bff; text-decoration: none;">mark them as ready</a>.
<? } else if (!d.dREV) { ?>
	Please make sure your files are on <strong style="box-sizing: border-box; font-weight: bolder;"><?= d.server.slice(4) ?></strong> at the file path* <u style="box-sizing: border-box;"><?= d.server[0] ?>:/<?= d.client ?>/<?= d.protocol ?>/z - To Assistant/<strong style="box-sizing: border-box; font-weight: bolder;"><?= d.timestamp && d.timestamp.format("YYYY.MM.DD") ?> -- <?= d.id ?></strong></u>.
<? } ?>
</p>

<p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">
<? if (d.hardDueDate) { ?>
	Your <strong style="box-sizing: border-box; font-weight: bolder;">hard</strong> deadline <?= bdText(d.hardDueDate && d.hardDueDate.format(dtfo), d.daysDue, 1) ?>.
<? } ?>

<? if (d.prefDueDate) { ?>
	Your <strong style="box-sizing: border-box; font-weight: bolder;">preferred</strong> deadline <?= bdText(d.prefDueDate && d.prefDueDate.format(dfo), d.daysPref, 1) ?>.
<? } ?>

<? if (d.expRetDate && d.daysExp >= 0) { ?>
	We currently <strong style="box-sizing: border-box; font-weight: bolder;">estimate</strong> that we will deliver the screenshots for your review <span class="text-info" style="box-sizing: border-box; color: #17a2b8 !important;"><?= bdText(d.expRetDate && d.expRetDate.format(dfo), d.daysExp, 0) ?></span>.
<? } ?>
</p>

<p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;"><span class="text-muted" style="box-sizing: border-box; color: #6c757d !important;">
	This is the <strong style="box-sizing: border-box; font-weight: bolder;"><?= ord(info.pos) ?></strong> request in our queue.

<? if (info.posNotStart) { ?>
	It is the <strong style="box-sizing: border-box; font-weight: bolder;"><?= ord(info.posNotStart) ?></strong> request out of those we have not yet started.
<? } ?>

    <? if (info.wkbksBefore) { ?>
    	There are approximately <?= info.wkbksBefore ?> workbooks ahead of this request <?
    if (info.wkbksBeforeNotStart) { ?>
        (of which <?= info.wkbksBeforeNotStart ?> have not been started).
    <? } else { ?>.<? } ?>
<? } ?>
</span></p>

<p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">
    Thank you,<br style="box-sizing: border-box;">
    The Assistants&trade;

<? if (!d.dRev) { ?>
</p><p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">
	<span class="text-muted" style="box-sizing: border-box; color: #6c757d !important; font-size: 75%;"><i style="box-sizing: border-box;">*It's ok if your file path is</i> slightly <i style="box-sizing: border-box;">different because of the way client/study folders are named.</i>
</span></p>
<? } ?>

<!-- <p style="white-space: pre-wrap;"><?= Logger.getLog() ?></p> -->

<table class="table table-striped table-sm" style="background-color: transparent; border-collapse: collapse; box-sizing: border-box; margin-bottom: 1rem; text-align: left; width: 100%;">
  <thead class="thead-dark" style="box-sizing: border-box;">
    <tr style="box-sizing: border-box;">
      <th scope="col" colspan="2" style="background-color: #212529; border-bottom: 2px solid #dee2e6; border-color: #32383e; border-top: 1px solid #dee2e6; box-sizing: border-box; color: #fff; padding: .3rem; text-align: inherit; vertical-align: bottom;">
        <table border="0" cellpadding="0" cellspacing="0" height="100%" width="100%" style="border-collapse: collapse; box-sizing: border-box;">
            <tr border="0" style="box-sizing: border-box;">
                <th style="background-color: #212529; border-bottom: 2px solid #dee2e6; border-color: #32383e; border-top: 1px solid #dee2e6; box-sizing: border-box; color: #fff; padding: .3rem; text-align: inherit; vertical-align: bottom;"><?= (d.client && (d.client + ' ')) + (d.protocol && (d.protocol + ' ')) + (d.batch && (' Batch ' + d.batch)) ?> &mdash; <?= d.reqCode ?></th>
                <th align="right" style="background-color: #212529; border-bottom: 2px solid #dee2e6; border-color: #32383e; border-top: 1px solid #dee2e6; box-sizing: border-box; color: #fff; padding: .3rem; text-align: right; vertical-align: bottom;"><?= d.id ?></th>
            </tr>
        </table>
      </th>
    </tr>    
  </thead>


  <tbody style="box-sizing: border-box;">
    <tr class="table-primary" style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="background-color: #b8daff; border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Status</th>
      <td style="background-color: #b8daff; border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.status ?></td>
    </tr>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Position in Queue</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= ord(info.pos) ?></td>
    </tr>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Estimated Return Date</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= (d.expRetDate && d.expRetDate.format(ldf)) || "(not estimated yet)" ?></td>
    </tr>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Assignee</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.asst || "(not assigned)" ?></td>
    </tr>

    <tr class="table-dark" style="background-color: rgba(0,0,0,.05); box-sizing: border-box; color: #fff;">
      <th scope="col" colspan="2" style="background-color: #c6c8ca; border-color: #32383e; border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Timeline</th>
    </tr>

<? if (d.dCPL) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Date Completed</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.dCPL.format(ldtf) ?></td>
    </tr>

<? } if (d.hardDueDate) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Hard Deadline</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.hardDueDate.format(ldtf) ?></td>
    </tr>

<? } if (d.prefDueDate) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Preferred Deadline</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.prefDueDate.format(ldf) ?></td>
    </tr>

<? } if (d.dRet) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Request First Returned</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.dRet.format(ldtf) ?></td>
    </tr>

<? } if (d.dINP) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Request Started</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.dINP.format(ldtf) ?></td>
    </tr>

<? } if (d.dFiles) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Files Received</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.dFiles.format(ldtf) ?></td>
    </tr>

<? } if (d.startDate) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Files Expected</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.startDate.format(ldf) ?></td>
    </tr>

<? } if (d.timestamp) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Request Received</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.timestamp.format(ldtf) ?></td>
    </tr>

<? } ?>




  </tbody>
</table></td></tr></table></td></tr></table></body></html>