<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" style="--blue: #007bff; --breakpoint-lg: 992px; --breakpoint-md: 768px; --breakpoint-sm: 576px; --breakpoint-xl: 1200px; --breakpoint-xs: 0; --cyan: #17a2b8; --danger: #dc3545; --dark: #343a40; --font-family-monospace: SFMono-Regular,Menlo,Monaco,Consolas,'Liberation Mono','Courier New',monospace; --font-family-sans-serif: -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji'; --gray: #6c757d; --gray-dark: #343a40; --green: #28a745; --indigo: #6610f2; --info: #17a2b8; --light: #f8f9fa; --orange: #fd7e14; --pink: #e83e8c; --primary: #007bff; --purple: #6f42c1; --red: #dc3545; --secondary: #6c757d; --success: #28a745; --teal: #20c997; --warning: #ffc107; --white: #fff; --yellow: #ffc107; -ms-overflow-style: scrollbar; -ms-text-size-adjust: 100%; -webkit-tap-highlight-color: transparent; -webkit-text-size-adjust: 100%; box-sizing: border-box; font-family: sans-serif; line-height: 1.15;">
    <head style="box-sizing: border-box;">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" style="box-sizing: border-box;">
        <title style="box-sizing: border-box;"></title>
        
	      <!-- <link rel="stylesheet" type="text/css" href="styles.css"> -->
        <div w3-include-html="../css.html" style="box-sizing: border-box;"></div>
        
    </head>
    <body style="background-color: #fff; box-sizing: border-box; color: #212529; font-family: -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji'; font-size: 1rem; font-weight: 400; line-height: 1.5; margin: 0; text-align: left;">
        <table border="0" cellpadding="0" cellspacing="0" height="100%" width="100%" id="bodyTable" style="border-collapse: collapse; box-sizing: border-box;">
            <tr style="box-sizing: border-box;">
                <td align="center" valign="top" style="box-sizing: border-box;">
                    <table border="0" cellpadding="20" cellspacing="0" id="emailContainer" style="border-collapse: collapse; box-sizing: border-box; max-width: 750px;">
                        <tr style="box-sizing: border-box;">
                            <td align="left" valign="top" style="box-sizing: border-box;">
                            
<? var info = position(d.row);
   var showEstRet = (d.expRetDate && d.daysExp >= 0 && (d.statusCode !== 'ONH') && (d.statusCode !== 'UNR') && (d.statusCode !== 'CPL') && (d.statusCode !== 'PND') && (d.statusCode !== 'CAN') && ev !== 2); ?>

<? if (testing) { ?>
  <p class="text-muted" style="box-sizing: border-box; color: #6c757d !important; font-size: 90%; margin-bottom: 1rem; margin-top: 0;"><i style="box-sizing: border-box;">
    FOR TESTING ONLY:<br style="box-sizing: border-box;">
    TO: <?= mail.to ?><br style="box-sizing: border-box;">
    CC: <?= mail.cc ?><br style="box-sizing: border-box;">
    REPLY TO: <?= mail.replyTo ?></i><br style="box-sizing: border-box;">
    <br style="box-sizing: border-box;">
    isRequestor: <?= isRequestor ?><br style="box-sizing: border-box;">
    hello: <?= hello ?>
  </p>
  <hr style="border: 0; border-top: 1px solid rgba(0,0,0,.1); box-sizing: content-box; height: 0; margin-bottom: 1rem; margin-top: 1rem; overflow: visible;">
<? } ?>


<h3 style="box-sizing: border-box; color: inherit; font-family: inherit; font-size: 1.75rem; font-weight: 500; line-height: 1.2; margin-bottom: .5rem; margin-top: 0;"><strong style="box-sizing: border-box; font-weight: bolder;"><?= mainTitle ?> </strong> / <?= d.id ?></h3>
<h4 style="box-sizing: border-box; color: inherit; font-family: inherit; font-size: 1.5rem; font-weight: 500; line-height: 1.2; margin-bottom: .5rem; margin-top: 0;"><?= d.client + ' ' + d.protocol + (d.batch && (' Batch ' + d.batch)) ?> &mdash; <?= d.reqCode ?></h4>

<h3 class="mt-3" style="box-sizing: border-box; color: inherit; font-family: inherit; font-size: 1.75rem; font-weight: 500; line-height: 1.2; margin-bottom: .5rem; margin-top: 1rem !important;"><?= d.status ?></h3>
<h5 class="mb-5 text-secondary" style="box-sizing: border-box; color: #6c757d !important; font-family: inherit; font-size: 1.25rem; font-weight: 500; line-height: 1.2; margin-bottom: 3rem !important; margin-top: 0;"><?= moment().format(ERTdf) ?></h5>

<? if (hello) { ?>
  <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">
      Hello<?= d.requestorNames && (" " + d.requestorNames[0]) ?>,
  </p>
<? } ?>

<!-- START OF DYNAMIC MESSAGE -->

<!-- NEW REQUEST message -->

<? if (ev == 0) { ?>
  <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">We have received your request for <strong style="box-sizing: border-box; font-weight: bolder;"><?= d.client + ' ' + d.protocol + (d.batch && (' Batch ' + d.batch)) + ' ' + d.reqType ?></strong>. We have assigned it the ID <span class="text-info" style="box-sizing: border-box; color: #17a2b8 !important;"><?= d.id ?></span><?
  if (d.dFiles) { 
    ?>. We will review the request and associated files and let you know if we need any information.<?
  } else if (d.statusCode == 'WFS') {
    ?> and set the status to <strong style="box-sizing: border-box; font-weight: bolder;"><span class="text-warning" style="box-sizing: border-box; color: #ffc107 !important;">waiting for start</span></strong>.<?
  } else {
    ?>.<?
  } ?>
<? } ?>


<!-- UPDATE FROM ASST -->

<? if (ev == 1 && d.statusCode != 'UNR' && d.statusCode != 'PND' && d.statusCode != 'ONH' && d.statusCode != 'CPL' && d.statusCode != 'CAN') {
  if (d.dINP) { ?>
    </p><p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">We are working on your request and wanted to send an update.</p>
  <? } else { ?>
    <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">We are reviewing open requests and wanted to send an update.</p>
  <? } ?>
  <? if (d.gennotes) { ?>
    <p style="box-sizing: border-box; margin-bottom: 1rem; margin-left: 1.5rem !important; margin-top: 0; white-space: pre-wrap;" class="ml-4"><i style="box-sizing: border-box;"><?= d.gennotes ?><i style="box-sizing: border-box;"></i></i></p>
  <? } ?>
<? } ?>


<!-- WAITING REMINDER -->

<? if (ev == 3) {
  if (d.statusCode == 'PND') { ?>
    <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">Are you satisfied with the screenshots we returned to you? If so, please select complete and close out this request. Otherwise, let us know how we can help!</p>
  <? } else if (d.statusCode == 'ONH') { ?>
    <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">We are waiting to complete your request because there are outstanding issues. If there's anything you can do to resolve these blockers, it will help us move forward.</p>
  <? } else if (d.statusCode !== 'WFS') { ?>
    <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">We are waiting to hear from you before we can move forward with your request.</p>
  <? }
} ?>


<!-- NEEDS INFORMATION message -->

<? if (d.statusCode == 'NIF') { ?>
  <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">We <strong style="box-sizing: border-box; font-weight: bolder;"><span class="text-danger" style="box-sizing: border-box; color: #dc3545 !important;">need information</span></strong> in order to proceed with your request.</p>
  <? if (d.gennotes) { ?>
    <p style="box-sizing: border-box; margin-bottom: 1rem; margin-left: 1.5rem !important; margin-top: 0; white-space: pre-wrap;" class="ml-4"><i style="box-sizing: border-box;"><?= d.gennotes ?><i style="box-sizing: border-box;"></i></i></p>
  <? } ?>
  <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">Please provide this information by <a href="<?= constURL ?>?page=Edit&row=<?= d.row ?>" style="-webkit-text-decoration-skip: objects; background-color: transparent; box-sizing: border-box; color: #007bff; text-decoration: underline;">editing</a> your request.</p>
<? } ?>


<!-- UN-RESOLVED ISSUES message -->

<? if (d.statusCode == 'UNR') { ?>
    <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">There are <strong style="box-sizing: border-box; font-weight: bolder;"><span class="text-danger" style="box-sizing: border-box; color: #dc3545 !important;">unresolved issues</span></strong> that are keeping us from delivering your request. Please review the information below, take appropriate action, then select one of the following options.</p>

    <div style="box-sizing: border-box;">
      <div class="btn-group btn-group-sm mb-3" role="group" style="box-sizing: border-box; display: inline-flex; margin-bottom: 1rem !important; position: relative; vertical-align: middle;">
        <a class="btn btn-inprogress" href="<?= constURL ?>?page=View&row=<?= d.row ?>&status=INP" style="-moz-user-select: none; -ms-flex: 0 1 auto; -ms-user-select: none; -webkit-text-decoration-skip: objects; -webkit-user-select: none; background-color: rgb(252, 229, 205); border: 1px solid transparent; border-bottom-right-radius: 0 !important; border-radius: .2rem; border-top-right-radius: 0 !important; box-sizing: border-box; color: #212529; cursor: pointer; display: inline-block; flex: 0 1 auto; font-size: .875rem; font-weight: 400; line-height: 1.5; margin-left: 0; padding: .25rem .5rem; position: relative; text-align: center; text-decoration: none; transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out; user-select: none; vertical-align: middle; white-space: nowrap;">Ready to Continue</a>
        <a class="btn btn-warning" href="<?= constURL ?>?page=View&row=<?= d.row ?>&status=ONH" style="-moz-user-select: none; -ms-flex: 0 1 auto; -ms-user-select: none; -webkit-text-decoration-skip: objects; -webkit-user-select: none; background-color: #ffc107; border: 1px solid transparent; border-bottom-left-radius: 0 !important; border-bottom-right-radius: 0 !important; border-color: #ffc107; border-radius: .2rem; border-top-left-radius: 0 !important; border-top-right-radius: 0 !important; box-sizing: border-box; color: #212529; cursor: pointer; display: inline-block; flex: 0 1 auto; font-size: .875rem; font-weight: 400; line-height: 1.5; margin-left: -1px; padding: .25rem .5rem; position: relative; text-align: center; text-decoration: none; transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out; user-select: none; vertical-align: middle; white-space: nowrap;">Place On-hold</a>
        <a class="btn btn-completed" href="<?= constURL ?>?page=View&row=<?= d.row ?>&status=CPL" style="-moz-user-select: none; -ms-flex: 0 1 auto; -ms-user-select: none; -webkit-text-decoration-skip: objects; -webkit-user-select: none; background-color: #6aa84f; background-image: none; border: 1px solid transparent; border-bottom-left-radius: 0 !important; border-color: #6aa84f; border-radius: .2rem; border-top-left-radius: 0 !important; box-sizing: border-box; color: #fff; cursor: pointer; display: inline-block; flex: 0 1 auto; font-size: .875rem; font-weight: 400; line-height: 1.5; margin-left: -1px; padding: .25rem .5rem; position: relative; text-align: center; text-decoration: none; transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out; user-select: none; vertical-align: middle; white-space: nowrap;">Completed</a>
      </div>
    </div>
<? } ?>


<!-- PENDING CONFIRMATION message -->

<? if (d.statusCode == 'PND') {
    if (d.fileloc) { ?>
        <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">Your request is ready for delivery <strong style="box-sizing: border-box; font-weight: bolder;"><span class="text-success" style="box-sizing: border-box; color: #28a745 !important;">pending confirmation</span></strong>. Please review the notes below and the associated files at <u style="box-sizing: border-box;"><?= d.fileloc ?></u> then select one of the following options.</p>
    <? } else { ?>
        <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">Your request is ready for delivery <strong style="box-sizing: border-box; font-weight: bolder;"><span class="text-success" style="box-sizing: border-box; color: #28a745 !important;">pending confirmation</span></strong>. Please review the notes below and the associated files then one of the following options.</p>
    <? } ?>

    <div style="box-sizing: border-box;">
      <div class="btn-group btn-group-sm mb-3" role="group" style="box-sizing: border-box; display: inline-flex; margin-bottom: 1rem !important; position: relative; vertical-align: middle;">
        <a class="btn btn-inprogress" href="<?= constURL ?>?page=View&row=<?= d.row ?>&status=INP" style="-moz-user-select: none; -ms-flex: 0 1 auto; -ms-user-select: none; -webkit-text-decoration-skip: objects; -webkit-user-select: none; background-color: rgb(252, 229, 205); border: 1px solid transparent; border-bottom-right-radius: 0 !important; border-radius: .2rem; border-top-right-radius: 0 !important; box-sizing: border-box; color: #212529; cursor: pointer; display: inline-block; flex: 0 1 auto; font-size: .875rem; font-weight: 400; line-height: 1.5; margin-left: 0; padding: .25rem .5rem; position: relative; text-align: center; text-decoration: none; transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out; user-select: none; vertical-align: middle; white-space: nowrap;">Needs Corrections</a>
        <a class="btn btn-warning" href="<?= constURL ?>?page=View&row=<?= d.row ?>&status=ONH" style="-moz-user-select: none; -ms-flex: 0 1 auto; -ms-user-select: none; -webkit-text-decoration-skip: objects; -webkit-user-select: none; background-color: #ffc107; border: 1px solid transparent; border-bottom-left-radius: 0 !important; border-bottom-right-radius: 0 !important; border-color: #ffc107; border-radius: .2rem; border-top-left-radius: 0 !important; border-top-right-radius: 0 !important; box-sizing: border-box; color: #212529; cursor: pointer; display: inline-block; flex: 0 1 auto; font-size: .875rem; font-weight: 400; line-height: 1.5; margin-left: -1px; padding: .25rem .5rem; position: relative; text-align: center; text-decoration: none; transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out; user-select: none; vertical-align: middle; white-space: nowrap;">Place On-hold</a>
        <a class="btn btn-completed" href="<?= constURL ?>?page=View&row=<?= d.row ?>&status=CPL" style="-moz-user-select: none; -ms-flex: 0 1 auto; -ms-user-select: none; -webkit-text-decoration-skip: objects; -webkit-user-select: none; background-color: #6aa84f; background-image: none; border: 1px solid transparent; border-bottom-left-radius: 0 !important; border-color: #6aa84f; border-radius: .2rem; border-top-left-radius: 0 !important; box-sizing: border-box; color: #fff; cursor: pointer; display: inline-block; flex: 0 1 auto; font-size: .875rem; font-weight: 400; line-height: 1.5; margin-left: -1px; padding: .25rem .5rem; position: relative; text-align: center; text-decoration: none; transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out; user-select: none; vertical-align: middle; white-space: nowrap;">Completed</a>
      </div>
    </div>
<? } ?>


<!-- ON-HOLD message -->

<? if (d.statusCode == 'ONH') {
    var whosReq = isRequestor ? "You placed this request" : "This request was placed";

    if (d.waitfor) { ?>
        <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;"><?= whosReq ?> <strong style="box-sizing: border-box; font-weight: bolder;"><span class="text-warning" style="box-sizing: border-box; color: #ffc107 !important;">on-hold</span></strong> because we are waiting for:</p>
        <p class="ml-4" style="box-sizing: border-box; margin-bottom: 1rem; margin-left: 1.5rem !important; margin-top: 0; white-space: pre-wrap;"><i style="box-sizing: border-box;"><?= d.waitfor.trim() ?></i></p>
        <? if (d.jira) { ?>
            <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">There are associated JIRA defects:</p>
            <p class="ml-4" style="box-sizing: border-box; margin-bottom: 1rem; margin-left: 1.5rem !important; margin-top: 0; white-space: pre-wrap;"><?= d.jira.trim() ?></p>
        <? } ?>
    <? } else if (d.jira) { ?>
        <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">Your request was placed <strong style="box-sizing: border-box; font-weight: bolder;"><span class="text-warning" style="box-sizing: border-box; color: #ffc107 !important;">on-hold</span></strong> because it cannot continue until the following defect(s) are resolved:</p>
        <p class="ml-4" style="box-sizing: border-box; margin-bottom: 1rem; margin-left: 1.5rem !important; margin-top: 0; white-space: pre-wrap;"><?= d.jira.trim() ?></p>
    <? } else { ?>
        <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">Your request was placed <strong style="box-sizing: border-box; font-weight: bolder;"><span class="text-warning" style="box-sizing: border-box; color: #ffc107 !important;">on-hold</span></strong> because there is an unresolved issue that is currently being resolved.
            <? if (d.asst) { ?>
                <?= d.asst ?> will get in touch if your assistance is required.<? } else { ?>We will get in touch if your assistance is required.
            <? } ?></p>
    <? } ?>
    <div style="box-sizing: border-box;">
      <div class="btn-group btn-group-sm mb-3" role="group" style="box-sizing: border-box; display: inline-flex; margin-bottom: 1rem !important; position: relative; vertical-align: middle;">
        <a class="btn btn-warning" href="<?= constURL ?>?page=View&row=<?= d.row ?>&status=ONH" style="-moz-user-select: none; -ms-flex: 0 1 auto; -ms-user-select: none; -webkit-text-decoration-skip: objects; -webkit-user-select: none; background-color: #ffc107; border: 1px solid transparent; border-bottom-right-radius: 0 !important; border-color: #ffc107; border-radius: .2rem; border-top-right-radius: 0 !important; box-sizing: border-box; color: #212529; cursor: pointer; display: inline-block; flex: 0 1 auto; font-size: .875rem; font-weight: 400; line-height: 1.5; margin-left: 0; padding: .25rem .5rem; position: relative; text-align: center; text-decoration: none; transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out; user-select: none; vertical-align: middle; white-space: nowrap;">Add a Note/Defect</a>
        <a class="btn btn-inprogress" href="<?= constURL ?>?page=View&row=<?= d.row ?>&status=INP" style="-moz-user-select: none; -ms-flex: 0 1 auto; -ms-user-select: none; -webkit-text-decoration-skip: objects; -webkit-user-select: none; background-color: rgb(252, 229, 205); border: 1px solid transparent; border-bottom-left-radius: 0 !important; border-bottom-right-radius: 0 !important; border-radius: .2rem; border-top-left-radius: 0 !important; border-top-right-radius: 0 !important; box-sizing: border-box; color: #212529; cursor: pointer; display: inline-block; flex: 0 1 auto; font-size: .875rem; font-weight: 400; line-height: 1.5; margin-left: -1px; padding: .25rem .5rem; position: relative; text-align: center; text-decoration: none; transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out; user-select: none; vertical-align: middle; white-space: nowrap;">Ready to Continue</a>
        <a class="btn btn-completed" href="<?= constURL ?>?page=View&row=<?= d.row ?>&status=CPL" style="-moz-user-select: none; -ms-flex: 0 1 auto; -ms-user-select: none; -webkit-text-decoration-skip: objects; -webkit-user-select: none; background-color: #6aa84f; background-image: none; border: 1px solid transparent; border-bottom-left-radius: 0 !important; border-color: #6aa84f; border-radius: .2rem; border-top-left-radius: 0 !important; box-sizing: border-box; color: #fff; cursor: pointer; display: inline-block; flex: 0 1 auto; font-size: .875rem; font-weight: 400; line-height: 1.5; margin-left: -1px; padding: .25rem .5rem; position: relative; text-align: center; text-decoration: none; transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out; user-select: none; vertical-align: middle; white-space: nowrap;">Completed</a>
      </div>
    </div>
<? } ?>


<!-- COMPLETED message -->

<? if (d.statusCode == 'CPL') { ?>
  <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">This request is now <strong style="box-sizing: border-box; font-weight: bolder;">complete</strong>. Thank you for working with us!</p>
  
  <div style="box-sizing: border-box;">
    <div class="btn-group btn-group-sm mb-3" role="group" style="box-sizing: border-box; display: inline-flex; margin-bottom: 1rem !important; position: relative; vertical-align: middle;">
      <a class="btn btn-inprogress" href="<?= constURL ?>?page=View&row=<?= d.row ?>&status=INP" style="-moz-user-select: none; -ms-flex: 0 1 auto; -ms-user-select: none; -webkit-text-decoration-skip: objects; -webkit-user-select: none; background-color: rgb(252, 229, 205); border: 1px solid transparent; border-radius: .2rem; box-sizing: border-box; color: #212529; cursor: pointer; display: inline-block; flex: 0 1 auto; font-size: .875rem; font-weight: 400; line-height: 1.5; margin-left: 0; padding: .25rem .5rem; position: relative; text-align: center; text-decoration: none; transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out; user-select: none; vertical-align: middle; white-space: nowrap;">Re-open</a>
    </div>
  </div>
<? } ?>


<!-- CANCELLED message -->

<? if (d.statusCode == 'CAN') { 
  
  if (isRequestor) { ?>
    <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">You marked this request as <strong style="box-sizing: border-box; font-weight: bolder;"><span class="text-secondary" style="box-sizing: border-box; color: #6c757d !important;">cancelled</span></strong>.</p>
  <? } else { ?>
    <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">This request was marked <strong style="box-sizing: border-box; font-weight: bolder;"><span class="text-secondary" style="box-sizing: border-box; color: #6c757d !important;">cancelled</span></strong> by <?= u.fname ?>.</p>
  <? } ?>
  <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">Please let us know if you would like to re-open it.</p>
<? } ?>


<!-- placing files on server -->

<!-- files not received -->
<? if ((d.statusCode == 'WFS' || !d.dFiles) && d.startDate && d.statusCode !== 'CAN' && ev !== 2) { ?>
	<p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">We <?= d.daysStart < 0 ? 'were' : 'are' ?> expecting your <strong style="box-sizing: border-box; font-weight: bolder;">files</strong> <span class="text-info" style="box-sizing: border-box; color: #17a2b8 !important;"><?= bdText(d.startDate && d.startDate.format(dfo), d.daysStart, 0) ?></span>. When they arrive, please place them on <strong style="box-sizing: border-box; font-weight: bolder;"><?= d.server.slice(4) ?></strong> at the file path* <u style="box-sizing: border-box;"><?= d.server[0] ?>:/<?= d.client ?>/<?= d.protocol ?>/z - To Assistant/<strong style="box-sizing: border-box; font-weight: bolder;"><?= moment().format("YYYY.MM.DD") ?> -- <?= d.id ?></strong></u> and <a href="<?= constURL ?>?page=View&row=<?= d.row ?>" class="text-success" target="_blank" style="-webkit-text-decoration-skip: objects; background-color: transparent; box-sizing: border-box; color: #28a745 !important; text-decoration: underline;">mark them as ready</a>.</p>

<!-- files not reviewed -->
<? } else if (!(d.dREV || d.dINP || d.dRet || d.dONH) && (d.statusCode !== 'CAN') && (d.statusCode !== 'CPL') && ev !== 2) { ?>
	<p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">Please make sure your files are on <strong style="box-sizing: border-box; font-weight: bolder;"><?= d.server.slice(4) ?></strong> at the file path* <u style="box-sizing: border-box;"><?= d.server[0] ?>:/<?= d.client ?>/<?= d.protocol ?>/z - To Assistant/<strong style="box-sizing: border-box; font-weight: bolder;"><?= d.timestamp && d.timestamp.format("YYYY.MM.DD") ?> -- <?= d.id ?></strong></u>.</p>
<? } ?>


<!-- estimated return -->


<? if (showEstRet) { ?>
	<p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">We currently <strong style="box-sizing: border-box; font-weight: bolder;">estimate</strong> that we will return screenshots for your review <span class="text-info" style="box-sizing: border-box; color: #17a2b8 !important;"><?= bdText(d.expRetDate && d.expRetDate.format(dfo), d.daysExp, 0) ?></span>.</p>
<? } ?>

<!-- END OF DYNAMIC MESSAGE -->

<? if (hello) { ?>
<p class="mt-3" style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 1rem !important;">
    Thank you,<br style="box-sizing: border-box;">
    The Assistants&trade;
</p>
<? } ?>


<!-- REQUEST EDITED -->

<? if (chg && Object.keys(chg).length) { ?>
  <p class="mt-5" style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 3rem !important;"><?= u.fname || u.email || 'Someone' ?> edited this request.</p>

  <? if (msg) { ?>
    <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;"><?= msg ?></p>
  <? } ?>

  <p style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;">The following information was changed:</p>
  <ul style="box-sizing: border-box; margin-bottom: 1rem; margin-top: 0;"><?

    for (var c in chg) { ?><li style="box-sizing: border-box;"><?

      if (typeof chg[c].old == 'object') {
        chg[c].old = moment(chg[c].old).format(df);
      }
      if (typeof chg[c].upd == 'object') {
        chg[c].upd = moment(chg[c].upd).format(df);
      }

      ?><?= chg[c].header ?> &mdash; <?

      if (chg[c].old) { 
        ?><i style="box-sizing: border-box;"><span class="text-muted" style="box-sizing: border-box; color: #6c757d !important;">from</span></i> <?= (chg[c].old.length > 30 ? chg[c].old.substring(0, 30) + '...' : chg[c].old) ?> <?
      } ?><i style="box-sizing: border-box;"><span class="text-muted" style="box-sizing: border-box; color: #6c757d !important;">to</span></i> <?

      if (chg[c].upd) {
        ?><?= (chg[c].upd.length > 30 ? chg[c].upd.substring(0, 30) + "..." : chg[c].upd)?><?
      }

      else {
        ?>""<?
      }

      ?></li><?
    } ?></ul>
<? } ?>


<!-- Actions -->
<div class="btn-group pb-3 mt-5" role="group" style="box-sizing: border-box; display: inline-flex; margin-top: 3rem !important; padding-bottom: 1rem !important; position: relative; vertical-align: middle;">
  <a class="btn btn-sm btn-outline-secondary" href="<?= constURL ?>?page=View&row=<?= d.row ?>" style="-moz-user-select: none; -ms-flex: 0 1 auto; -ms-user-select: none; -webkit-text-decoration-skip: objects; -webkit-user-select: none; background-color: transparent; background-image: none; border: 1px solid transparent; border-bottom-right-radius: 0 !important; border-color: #6c757d; border-radius: .2rem; border-top-right-radius: 0 !important; box-sizing: border-box; color: #6c757d; cursor: pointer; display: inline-block; flex: 0 1 auto; font-size: .875rem; font-weight: 400; line-height: 1.5; margin-left: 0; padding: .25rem .5rem; position: relative; text-align: center; text-decoration: none; transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out; user-select: none; vertical-align: middle; white-space: nowrap;">View</a>
  <a class="btn btn-sm btn-outline-secondary" href="<?= constURL ?>?page=Edit&row=<?= d.row ?>" style="-moz-user-select: none; -ms-flex: 0 1 auto; -ms-user-select: none; -webkit-text-decoration-skip: objects; -webkit-user-select: none; background-color: transparent; background-image: none; border: 1px solid transparent; border-bottom-left-radius: 0 !important; border-bottom-right-radius: 0 !important; border-color: #6c757d; border-radius: .2rem; border-top-left-radius: 0 !important; border-top-right-radius: 0 !important; box-sizing: border-box; color: #6c757d; cursor: pointer; display: inline-block; flex: 0 1 auto; font-size: .875rem; font-weight: 400; line-height: 1.5; margin-left: -1px; padding: .25rem .5rem; position: relative; text-align: center; text-decoration: none; transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out; user-select: none; vertical-align: middle; white-space: nowrap;">Edit</a>
  <a class="btn btn-sm btn-outline-secondary" href="<?= constURL ?>?page=View&row=<?= d.row ?>&status=CAN" style="-moz-user-select: none; -ms-flex: 0 1 auto; -ms-user-select: none; -webkit-text-decoration-skip: objects; -webkit-user-select: none; background-color: transparent; background-image: none; border: 1px solid transparent; border-bottom-left-radius: 0 !important; border-color: #6c757d; border-radius: .2rem; border-top-left-radius: 0 !important; box-sizing: border-box; color: #6c757d; cursor: pointer; display: inline-block; flex: 0 1 auto; font-size: .875rem; font-weight: 400; line-height: 1.5; margin-left: -1px; padding: .25rem .5rem; position: relative; text-align: center; text-decoration: none; transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out; user-select: none; vertical-align: middle; white-space: nowrap;">Cancel</a>
</div>

<!-- Status Info -->

<p class="text-muted" style="box-sizing: border-box; color: #6c757d !important; margin-bottom: 1rem; margin-top: 0;">
<? if (d.hardDueDate) { ?>
    Your <strong style="box-sizing: border-box; font-weight: bolder;">hard</strong> deadline <?= bdText(d.hardDueDate && d.hardDueDate.format(dtfo), d.daysDue, 1) ?>.<br style="box-sizing: border-box;">
<? } ?>

<? if (d.prefDueDate) { ?>
    Your <strong style="box-sizing: border-box; font-weight: bolder;">preferred</strong> deadline <?= bdText(d.prefDueDate && d.prefDueDate.format(dfo), d.daysPref, 1) ?>.
<? } ?>
</p>

<? if (info.pos) { ?>
  <p class="text-muted" style="box-sizing: border-box; color: #6c757d !important; margin-bottom: 1rem; margin-top: 0;">
      This is the <strong style="box-sizing: border-box; font-weight: bolder;"><?= ord(info.pos) ?></strong> request in our <a href="<?= constURL ?>" style="-webkit-text-decoration-skip: objects; background-color: transparent; box-sizing: border-box; color: #007bff; text-decoration: underline;">queue</a>.

  <? if (info.posNotStart) { ?>
      It is the <strong style="box-sizing: border-box; font-weight: bolder;"><?= ord(info.posNotStart) ?></strong> request out of those we have not yet started.
  <? } ?>

      <? if (info.wkbksBefore) { ?>
          There are approximately <?= info.wkbksBefore ?> workbooks ahead of this request<?
        if (info.posNotStart) { 
          if (!info.wkbksBeforeNotStart) {
            ?>, all of which have been started.<?
          } else {
            ?> (of which <?= info.wkbksBeforeNotStart ?> have not been started).<?
          }
        } else { ?>.<? } ?>
  <? } ?>
  </p>
<? } ?>

<? if (!(d.dREV || d.dINP || d.dRet || d.dONH)) { ?>
<p lass="text-muted" style="box-sizing: border-box; font-size: 75%; margin-bottom: 1rem; margin-top: 0;">
	<i style="box-sizing: border-box;">*It's ok if your file path is</i> slightly <i style="box-sizing: border-box;">different because of the way client/study folders are named. Please use the date that your files arrived. Adding the ID really helps us find the files quickly!</i>
</p>
<? } ?>

<? if (showEstRet) { ?>
<p span="" class="text-muted" style="box-sizing: border-box; color: #6c757d !important; font-size: 75%; line-height: 1.27 !important; margin-bottom: 1rem; margin-top: 0;">
  <i style="box-sizing: border-box;">Our estimated return dates for all requests are subject to change as the queue fluctuates and requests take shorter or longer than expected. We always strive to return screenshots to you as soon as possible, and certainly by your hard deadline, but we do ask for your patience when this is not possible. Thanks!</i>
</p>
<? } ?>


<!-- Summary Table -->

<table class="table table-striped table-sm mt-5" style="background-color: transparent; border-collapse: collapse; box-sizing: border-box; margin-bottom: 1rem; margin-top: 3rem !important; text-align: left; width: 100%;">
  <thead class="thead-dark" style="box-sizing: border-box;"> <!-- style="background-color: #212529; border-color: #32383e" -->
    <tr style="box-sizing: border-box;">
      <th scope="col" colspan="2" style="background-color: #212529; border-bottom: 2px solid #dee2e6; border-color: #32383e; border-top: 1px solid #dee2e6; box-sizing: border-box; color: #fff; padding: .3rem; text-align: inherit; vertical-align: bottom;">
        <table border="0" cellpadding="0" cellspacing="0" height="100%" width="100%" style="border-collapse: collapse; box-sizing: border-box;">
            <tr style="border: 0; box-sizing: border-box;">
                <th class="py-2" style="background-color: #212529; border: 0 !important; border-bottom: 2px solid #dee2e6; border-color: #32383e; border-top: 1px solid #dee2e6; box-sizing: border-box; color: #fff; padding: .3rem; padding-bottom: .5rem !important; padding-top: .5rem !important; text-align: inherit; vertical-align: bottom;"><?= (d.client && (d.client + ' ')) + (d.protocol && (d.protocol + ' ')) + (d.batch && (' Batch ' + d.batch)) ?> &mdash; <?= d.reqCode ?></th>
                <th class="py-2" align="right" style="background-color: #212529; border: 0 !important; border-bottom: 2px solid #dee2e6; border-color: #32383e; border-top: 1px solid #dee2e6; box-sizing: border-box; color: #fff; padding: .3rem; padding-bottom: .5rem !important; padding-top: .5rem !important; text-align: right; vertical-align: bottom;"><?= d.id ?></th>
            </tr>
        </table>
      </th>
    </tr>    
  </thead>


<!-- Status -->

  <tbody style="box-sizing: border-box; white-space: pre-wrap;">
    <tr class="table-primary" style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="background-color: #b8daff; border-top: 1px solid #dee2e6; box-sizing: border-box; min-width: 215px; padding: .3rem; text-align: inherit; vertical-align: top;">Status</th>
      <td style="background-color: #b8daff; border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><strong style="box-sizing: border-box; font-weight: bolder;"><?= d.status ?></strong></td>
    </tr>

<? if (info.pos) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Position in Queue</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= ord(info.pos) ?></td>
    </tr>
<? } ?>

<? if (d.expRetDate && (d.statusCode !== 'ONH') && (d.statusCode !== 'UNR') && (d.statusCode !== 'CPL') && (d.statusCode !== 'PND') && (d.statusCode !== 'CAN')) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Estimated Return Date</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= (d.expRetDate && d.expRetDate.format(ldf)) || "(not estimated yet)" ?></td>
    </tr>
<? } ?>

    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Assignee</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.asst || "(not assigned)" ?></td>
    </tr>


<!-- Performance Notes -->

<? if (d.majIssues || d.minIssues || d.gennotes || d.vendiss) { ?>
    <tr class="table-dark" style="background-color: rgba(0,0,0,.05); box-sizing: border-box; color: #fff;">
      <th scope="col" colspan="2" style="background-color: #c6c8ca; border-color: #32383e; border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Performance Notes</th>
    </tr>

<? if (d.majIssues) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Major Issues (Blockers)</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.majIssues ?></td>
    </tr>

<? } if (d.minIssues) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Minor Issues</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.minIssues ?></td>
    </tr>

<? } if (d.gennotes) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">General Notes</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.gennotes ?></td>
    </tr>

<? } if (d.vendiss) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Vendor Mistakes</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.vendiss ?></td>
    </tr>
<? } } ?>


<!-- Follow-up -->

<? if (d.tcfdbk || d.waitfor || d.jira) { ?>
    <tr class="table-dark" style="background-color: #212529; box-sizing: border-box; color: #fff;">
      <th scope="col" colspan="2" style="background-color: #c6c8ca; border-color: #32383e; border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Follow-up</th>
    </tr>

<? if (d.tcfdbk) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Requestor Feedback</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.tcfdbk ?></td>
    </tr>

<? } if (d.waitfor) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">On-hold: Waiting For</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.waitfor ?></td>
    </tr>

<? } if (d.jira) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Associated JIRA Defects</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.jira ?></td>
    </tr>
<? } } ?>


<!-- Timeline -->

    <tr class="table-dark" style="background-color: #212529; box-sizing: border-box; color: #fff;">
      <th scope="col" colspan="2" style="background-color: #c6c8ca; border-color: #32383e; border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Timeline</th>
    </tr>

<? if (d.dCPL) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Date Completed</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.dCPL.format(ldtf) ?></td>
    </tr>

<? } if (d.hardDueDate) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Hard Deadline</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.hardDueDate.format(ldtf) ?></td>
    </tr>

<? } if (d.prefDueDate) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Preferred Deadline</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.prefDueDate.format(ldf) ?></td>
    </tr>

<? } if (d.dPND) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Returned Pending Confirmation</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.dPND.format(ldtf) ?></td>
    </tr>

<? } if (d.dUNR) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Returned w/ Unresolved Issues</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.dUNR.format(ldtf) ?></td>
    </tr>

<? } if (d.dONHend) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">On-hold Ended</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.dONHend.format(ldtf) ?></td>
    </tr>

<? } if (d.dONH) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Placed On-hold</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.dONH.format(ldtf) ?></td>
    </tr>

<? } if (d.dRet) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Request First Returned</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.dRet.format(ldtf) ?></td>
    </tr>

<? } if (d.dINP) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Screenshots Started</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.dINP.format(ldtf) ?></td>
    </tr>

<? } if (d.dREV) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Reviewed &amp; Ready</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.dREV.format(ldtf) ?></td>
    </tr>

<? } if (d.dNIF) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Needed Information</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.dNIF.format(ldtf) ?></td>
    </tr>

<? } if (d.dFiles) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Files Received</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.dFiles.format(ldtf) ?></td>
    </tr>

<? } if (d.startDate && d.dWFS) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Files Expected</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.startDate.format(ldf) ?></td>
    </tr>

<? } if (d.timestamp) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Request Received</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.timestamp.format(ldtf) ?></td>
    </tr>

<? } ?>


<!-- Request Basics -->

<tr class="table-dark" style="background-color: rgba(0,0,0,.05); box-sizing: border-box; color: #fff;">
      <th scope="col" colspan="2" style="background-color: #c6c8ca; border-color: #32383e; border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Request Basics</th>
    </tr>

<? if (d.requestor) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Requested By</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.requestor ?></td>
    </tr>

<? } if (d.reqType) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Type</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.reqType ?></td>
    </tr>

<? } if (d.batch) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Batch</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.batch ?></td>
    </tr>

<? } if (d.langsV001) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Languages (v0.01)</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.langsV001 ?></td>
    </tr>

<? } if (d.langsCR) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Languages (corrections)</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.langsCR ?></td>
    </tr>

<? } if (d.cpyast) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Copyrighted Assessments</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.cpyast ?></td>
    </tr>

<? } if (d.nonast) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Non-Copyrighted Assessments</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.nonast ?></td>
    </tr>

<? } if (d.langCnt) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;"># Languages</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.langCnt ?></td>
    </tr>

<? } if (d.astCnt) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;"># Assessments</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.astCnt ?></td>
    </tr>

<? } if (d.bestwkbks && parseInt(d.bestwkbks)) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Workbooks</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.bestwkbks + (!d.actwkbks ? " (predicted)" : '') ?></td>
    </tr>
<? } ?>


<!-- Request Details -->

<? if (d.dvcbld || d.msgbx || d.manscr || d.temp || d.naming || d.server || d.addlnotes) { ?>
    <tr class="table-dark" style="background-color: #212529; box-sizing: border-box; color: #fff;">
      <th scope="col" colspan="2" style="background-color: #c6c8ca; border-color: #32383e; border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Request Details</th>
    </tr>

<? if (d.dvcbld) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Device &amp; Build</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.dvcbld ?></td>
    </tr>

<? } if (d.msgbx) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Messageboxes Required</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.msgbx ?></td>
    </tr>

<? } if (d.manscr) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Manual Screen Capture Required</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.manscr ?></td>
    </tr>

<? } if (d.temp) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Excel Template</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.temp ?></td>
    </tr>

<? } if (d.naming) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Naming Conventions</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.naming ?></td>
    </tr>

<? } if (d.server) { ?>
    <tr style="box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Server</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.server ?></td>
    </tr>

<? } if (d.addlnotes) { ?>
    <tr style="background-color: rgba(0,0,0,.05); box-sizing: border-box;">
      <th scope="row" style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; text-align: inherit; vertical-align: top;">Additional Notes</th>
      <td style="border-top: 1px solid #dee2e6; box-sizing: border-box; padding: .3rem; vertical-align: top;"><?= d.addlnotes ?></td>
    </tr>
<? } } ?>


  </tbody>
</table></td></tr></table></td></tr></table></body></html>